parameters:
  dotnetSdkVersions: []

jobs:
  - job: UnitTests
    displayName: 'Run unit tests'
    pool:
      vmImage: 'ubuntu-16.04'
    steps:
      - ${{ each version in parameters.dotnetSdkVersions }}:
          - task: DownloadPipelineArtifact@2
            displayName: 'Download build artifacts'
            inputs:
              artifact: 'Build-${{ version }}'
              path: '$(Build.SourcesDirectory)'
          - task: DotNetCoreInstaller@0
            displayName: 'Import .NET Core SDK (${{ version }})'
            inputs:
              version: '${{ version }}'
          - task: DotNetCoreCLI@2
            displayName: 'Run unit tests'
            inputs:
              command: test
              projects: 'src/**/$(Project).Unit.csproj'
              arguments: '--configuration $(Build.Configuration)'
              nobuild: true
              publishTestResults: true
